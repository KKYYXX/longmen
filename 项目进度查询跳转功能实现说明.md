# 项目进度查询跳转功能实现说明

## 功能概述

本次更新实现了在fifteenprojectsquery页面中，点击时间查询按钮或搜索具体日期后，自动跳转到项目进度内容页面的功能。项目进度内容页面采用了与前面页面一致的淡黄色主题风格，顶部显示"项目进度内容"标题。

## 主要功能特性

### 1. 自动跳转功能
- **时间范围按钮跳转**：点击"最近一周"、"最近一月"、"最近三月"、"最近半年"、"最近一年"等按钮后，自动跳转到项目进度内容页面
- **自定义时间查询跳转**：选择具体开始和结束日期后，点击"查询"按钮，自动跳转到项目进度内容页面
- **参数传递**：跳转时自动传递项目信息、时间范围等参数到目标页面

### 2. 页面风格统一
- **颜色主题**：采用与fifteenprojectsquery页面一致的淡黄色渐变背景
- **视觉元素**：使用相同的圆角、阴影、渐变效果
- **布局风格**：保持一致的卡片式布局和间距设计

### 3. 功能完整性
- **项目信息显示**：显示项目名称和查询时间范围
- **进度查询功能**：支持预设时间范围和自定义时间查询
- **进度记录展示**：完整显示进度记录的人员、时间、地点、内容等信息
- **多媒体支持**：支持图片、视频、文件等多媒体资源的展示

## 技术实现细节

### 1. 页面跳转实现
```javascript
// 在fifteenprojectsquery.js中添加跳转函数
navigateToProgressContent: function(timeRange, customStartDate, customEndDate) {
  // 准备参数
  const params = {
    projectId: this.data.selectedProject.id,
    projectName: this.data.selectedProject.projectName,
    timeRange: timeRange
  };
  
  // 计算时间范围
  if (timeRange !== 'custom') {
    // 预设时间范围计算
    const endDate = new Date();
    const startDate = new Date();
    // ... 时间计算逻辑
    params.startDate = this.formatDate(startDate);
    params.endDate = this.formatDate(endDate);
  } else {
    // 自定义时间
    params.startDate = customStartDate;
    params.endDate = customEndDate;
  }
  
  // 执行跳转
  wx.navigateTo({
    url: '/pages/项目进度内容/项目进度内容',
    success: (res) => {
      // 传递参数
      if (res.eventChannel) {
        res.eventChannel.emit('acceptDataFromOpenerPage', params);
      }
    }
  });
}
```

### 2. 参数接收处理
```javascript
// 在项目进度内容页面的onLoad中接收参数
onLoad: function(options) {
  const eventChannel = this.getOpenerEventChannel();
  eventChannel.on('acceptDataFromOpenerPage', (data) => {
    this.setData({
      projectInfo: data
    });
    
    // 自动执行进度查询
    if (data.timeRange && data.timeRange !== 'custom') {
      this.queryProgressByTimeRange(data.timeRange);
    } else if (data.startDate && data.endDate) {
      this.queryProgressByCustomTime(data.startDate, data.endDate);
    }
  });
}
```

### 3. 样式统一实现
```css
/* 使用与fifteenprojectsquery页面一致的样式 */
page {
  background: linear-gradient(180deg, #fffbf0 0%, #ffffff 30%, #fff8e1 100%);
}

.page-header {
  background: linear-gradient(135deg, #f9e286 0%, #f0e68c 100%);
  box-shadow: 0 4rpx 20rpx rgba(249, 226, 134, 0.2);
}

.time-query-section {
  background: linear-gradient(135deg, #f9e286 0%, #f0e68c 100%);
  box-shadow: 0 4rpx 20rpx rgba(249, 226, 134, 0.2);
}
```

## 使用流程

### 1. 基本使用流程
1. 在fifteenprojectsquery页面选择项目，点击"查看详情"
2. 在项目详情弹窗中，选择时间范围按钮或自定义时间
3. 系统自动跳转到项目进度内容页面
4. 页面自动显示项目信息和执行进度查询
5. 显示查询结果和进度记录

### 2. 时间查询方式
- **快速查询**：点击预设时间范围按钮（一周、一月、三月、半年、一年）
- **精确查询**：选择具体的开始和结束日期，点击查询按钮

### 3. 进度记录展示
- **基本信息**：人员、时间、地点、工作内容
- **多媒体资源**：现场图片、视频、相关文件
- **操作功能**：分享、导出等（预留接口）

## 页面结构

### 1. 页面头部
- 页面标题："项目进度内容"
- 淡黄色渐变背景，圆角设计

### 2. 项目信息区域
- 项目名称显示
- 查询时间范围显示
- 卡片式布局，半透明背景

### 3. 时间查询区域
- 预设时间范围按钮
- 自定义时间选择器
- 查询按钮

### 4. 进度记录区域
- 加载状态提示
- 进度记录列表
- 无记录提示
- 空状态显示

## 注意事项

### 1. 使用前提
- 必须先选择项目才能进行跳转
- 项目进度内容页面需要后端接口支持

### 2. 错误处理
- 网络请求失败时显示友好提示
- 无数据时显示相应状态提示
- 参数错误时进行验证和提示

### 3. 性能优化
- 页面跳转时自动执行查询，减少用户等待
- 支持图片预览和视频播放
- 响应式设计，适配不同屏幕尺寸

## 后续扩展建议

### 1. 功能增强
- 添加进度记录筛选和排序功能
- 实现进度统计图表展示
- 支持进度记录导出为PDF或Excel

### 2. 用户体验
- 添加进度查询历史记录
- 实现进度记录收藏功能
- 支持进度记录评论和反馈

### 3. 技术优化
- 添加数据缓存机制
- 实现离线数据支持
- 优化图片和视频加载性能

## 总结

本次功能实现成功地将fifteenprojectsquery页面的进度查询功能与项目进度内容页面进行了无缝集成，实现了：

1. **功能完整性**：从查询到展示的完整流程
2. **用户体验**：自动跳转和参数传递，减少用户操作步骤
3. **视觉统一**：保持与现有页面一致的风格和布局
4. **技术规范**：使用微信小程序标准的事件通道机制进行页面间通信

该功能为用户提供了更加便捷和直观的项目进度查询体验，同时保持了整个应用的设计一致性。
