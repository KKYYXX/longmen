# 后端接口文档

## 基础信息
- 基础URL: `http://127.0.0.1:5000`
- 认证方式: Bearer Token
- 请求头: `Authorization: Bearer {token}`

## 用户权限相关接口

### 1. 获取用户权限
- **接口**: `GET /api/user/permissions`
- **描述**: 获取当前用户的权限列表
- **请求头**: 
  ```
  Authorization: Bearer {token}
  ```
- **响应示例**:
  ```json
  {
    "success": true,
    "permissions": ["add_typical_case", "add_fifteen_project", "modify_typical_case", "delete_typical_case"]
  }
  ```

## 典型案例相关接口

### 2. 上传文件
- **接口**: `POST /api/typical-cases/upload-files`
- **描述**: 上传典型案例相关文件
- **请求方式**: `multipart/form-data`
- **请求参数**:
  - `file`: 文件对象
  - `fileType`: 文件类型 (pdf/doc/xlsx/image)
  - `caseId`: 案例ID
- **响应示例**:
  ```json
  {
    "success": true,
    "fileId": "file_123456",
    "fileUrl": "http://example.com/files/document.pdf",
    "message": "文件上传成功"
  }
  ```

### 3. 添加新闻链接
- **接口**: `POST /api/typical-cases/add-news-link`
- **描述**: 添加典型案例相关新闻链接
- **请求参数**:
  ```json
  {
    "title": "新闻标题",
    "url": "http://example.com/news/123",
    "caseId": "case_123456"
  }
  ```
- **响应示例**:
  ```json
  {
    "success": true,
    "linkId": "link_123456",
    "message": "新闻链接添加成功"
  }
  ```

### 4. 上传视频
- **接口**: `POST /api/typical-cases/upload-videos`
- **描述**: 上传典型案例相关视频
- **请求方式**: `multipart/form-data`
- **请求参数**:
  - `video`: 视频文件
  - `caseId`: 案例ID
- **响应示例**:
  ```json
  {
    "success": true,
    "videoId": "video_123456",
    "videoUrl": "http://example.com/videos/video.mp4",
    "message": "视频上传成功"
  }
  ```

### 5. 删除文件
- **接口**: `DELETE /api/typical-cases/delete-file/{fileId}`
- **描述**: 删除已上传的文件
- **响应示例**:
  ```json
  {
    "success": true,
    "message": "文件删除成功"
  }
  ```

### 6. 删除新闻链接
- **接口**: `DELETE /api/typical-cases/delete-news-link/{linkId}`
- **描述**: 删除已添加的新闻链接
- **响应示例**:
  ```json
  {
    "success": true,
    "message": "新闻链接删除成功"
  }
  ```

### 7. 删除视频
- **接口**: `DELETE /api/typical-cases/delete-video/{videoId}`
- **描述**: 删除已上传的视频
- **响应示例**:
  ```json
  {
    "success": true,
    "message": "视频删除成功"
  }
  ```

### 8. 提交所有内容
- **接口**: `POST /api/typical-cases/submit-content`
- **描述**: 提交所有上传的内容
- **请求参数**:
  ```json
  {
    "files": [
      {
        "id": "file_123",
        "name": "document.pdf",
        "url": "http://example.com/files/document.pdf",
        "type": "pdf",
        "size": 1024000,
        "uploadTime": "2024-01-01T12:00:00Z"
      }
    ],
    "newsLinks": [
      {
        "id": "link_123",
        "title": "新闻标题",
        "url": "http://example.com/news/123",
        "addTime": "2024-01-01T12:00:00Z"
      }
    ],
    "videos": [
      {
        "id": "video_123",
        "name": "video.mp4",
        "url": "http://example.com/videos/video.mp4",
        "size": 2048000,
        "duration": 120,
        "uploadTime": "2024-01-01T12:00:00Z"
      }
    ],
    "submitTime": "2024-01-01T12:00:00Z"
  }
  ```
- **响应示例**:
  ```json
  {
    "success": true,
    "caseId": "case_123456",
    "message": "内容提交成功"
  }
  ```

### 9. 获取案例列表
- **接口**: `GET /api/typical-cases/list`
- **描述**: 获取典型案例列表
- **响应示例**:
  ```json
  {
    "success": true,
    "cases": [
      {
        "id": "case_123",
        "title": "案例标题",
        "category": "基础设施建设",
        "summary": "案例摘要",
        "createDate": "2024-01-01",
        "updateDate": "2024-01-01",
        "status": "已发布"
      }
    ]
  }
  ```

## 十五项项目相关接口

### 10. 上传项目文件
- **接口**: `POST /api/fifteen-projects/upload-files`
- **描述**: 上传十五项项目相关文件
- **请求方式**: `multipart/form-data`
- **请求参数**:
  - `file`: 文件对象
  - `fileType`: 文件类型 (pdf/doc/xlsx/image)
  - `projectId`: 项目ID
- **响应示例**:
  ```json
  {
    "success": true,
    "fileId": "file_123456",
    "fileUrl": "http://example.com/files/document.pdf",
    "message": "文件上传成功"
  }
  ```

### 11. 添加项目新闻链接
- **接口**: `POST /api/fifteen-projects/add-news-link`
- **描述**: 添加十五项项目相关新闻链接
- **请求参数**:
  ```json
  {
    "title": "新闻标题",
    "url": "http://example.com/news/123",
    "projectId": "project_123456"
  }
  ```
- **响应示例**:
  ```json
  {
    "success": true,
    "linkId": "link_123456",
    "message": "新闻链接添加成功"
  }
  ```

### 12. 上传项目视频
- **接口**: `POST /api/fifteen-projects/upload-videos`
- **描述**: 上传十五项项目相关视频
- **请求方式**: `multipart/form-data`
- **请求参数**:
  - `video`: 视频文件
  - `projectId`: 项目ID
- **响应示例**:
  ```json
  {
    "success": true,
    "videoId": "video_123456",
    "videoUrl": "http://example.com/videos/video.mp4",
    "message": "视频上传成功"
  }
  ```

### 13. 删除项目文件
- **接口**: `DELETE /api/fifteen-projects/delete-file/{fileId}`
- **描述**: 删除已上传的项目文件
- **响应示例**:
  ```json
  {
    "success": true,
    "message": "文件删除成功"
  }
  ```

### 14. 删除项目新闻链接
- **接口**: `DELETE /api/fifteen-projects/delete-news-link/{linkId}`
- **描述**: 删除已添加的项目新闻链接
- **响应示例**:
  ```json
  {
    "success": true,
    "message": "新闻链接删除成功"
  }
  ```

### 15. 删除项目视频
- **接口**: `DELETE /api/fifteen-projects/delete-video/{videoId}`
- **描述**: 删除已上传的项目视频
- **响应示例**:
  ```json
  {
    "success": true,
    "message": "视频删除成功"
  }
  ```

### 16. 提交项目内容
- **接口**: `POST /api/fifteen-projects/submit-content`
- **描述**: 提交所有上传的项目内容
- **请求参数**:
  ```json
  {
    "files": [
      {
        "id": "file_123",
        "name": "document.pdf",
        "url": "http://example.com/files/document.pdf",
        "type": "pdf",
        "size": 1024000,
        "uploadTime": "2024-01-01T12:00:00Z"
      }
    ],
    "newsLinks": [
      {
        "id": "link_123",
        "title": "新闻标题",
        "url": "http://example.com/news/123",
        "addTime": "2024-01-01T12:00:00Z"
      }
    ],
    "videos": [
      {
        "id": "video_123",
        "name": "video.mp4",
        "url": "http://example.com/videos/video.mp4",
        "size": 2048000,
        "duration": 120,
        "uploadTime": "2024-01-01T12:00:00Z"
      }
    ],
    "submitTime": "2024-01-01T12:00:00Z"
  }
  ```
- **响应示例**:
  ```json
  {
    "success": true,
    "projectId": "project_123456",
    "message": "内容提交成功"
  }
  ```

### 17. 获取项目列表
- **接口**: `GET /api/fifteen-projects/list`
- **描述**: 获取十五项项目列表
- **响应示例**:
  ```json
  {
    "success": true,
    "projects": [
      {
        "id": "project_123",
        "title": "项目标题",
        "category": "基础设施建设",
        "summary": "项目摘要",
        "createDate": "2024-01-01",
        "updateDate": "2024-01-01",
        "status": "进行中"
      }
    ]
  }
  ```

## 错误响应格式

所有接口在发生错误时都应该返回以下格式：

```json
{
  "success": false,
  "message": "错误描述信息",
  "errorCode": "ERROR_CODE"
}
```

## 数据库表结构建议

### 用户权限表 (user_permissions)
```sql
CREATE TABLE user_permissions (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id VARCHAR(50) NOT NULL,
    permission VARCHAR(100) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

### 典型案例表 (typical_cases)
```sql
CREATE TABLE typical_cases (
    id VARCHAR(50) PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    category VARCHAR(100),
    summary TEXT,
    content TEXT,
    achievements TEXT,
    experience TEXT,
    author VARCHAR(100),
    contact VARCHAR(100),
    tags JSON,
    create_date DATE,
    update_date DATE,
    status VARCHAR(20) DEFAULT '已发布',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

### 典型案例文件表 (typical_case_files)
```sql
CREATE TABLE typical_case_files (
    id VARCHAR(50) PRIMARY KEY,
    case_id VARCHAR(50) NOT NULL,
    file_name VARCHAR(200) NOT NULL,
    file_url VARCHAR(500) NOT NULL,
    file_type VARCHAR(20) NOT NULL,
    file_size BIGINT,
    upload_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (case_id) REFERENCES typical_cases(id)
);
```

### 典型案例新闻链接表 (typical_case_news_links)
```sql
CREATE TABLE typical_case_news_links (
    id VARCHAR(50) PRIMARY KEY,
    case_id VARCHAR(50) NOT NULL,
    title VARCHAR(200) NOT NULL,
    url VARCHAR(500) NOT NULL,
    add_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (case_id) REFERENCES typical_cases(id)
);
```

### 典型案例视频表 (typical_case_videos)
```sql
CREATE TABLE typical_case_videos (
    id VARCHAR(50) PRIMARY KEY,
    case_id VARCHAR(50) NOT NULL,
    video_name VARCHAR(200) NOT NULL,
    video_url VARCHAR(500) NOT NULL,
    video_size BIGINT,
    duration INT,
    upload_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (case_id) REFERENCES typical_cases(id)
);
```

### 十五项项目表 (fifteen_projects)
```sql
CREATE TABLE fifteen_projects (
    id VARCHAR(50) PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    category VARCHAR(100),
    summary TEXT,
    content TEXT,
    progress INT DEFAULT 0,
    status VARCHAR(20) DEFAULT '进行中',
    create_date DATE,
    update_date DATE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

### 十五项项目文件表 (fifteen_project_files)
```sql
CREATE TABLE fifteen_project_files (
    id VARCHAR(50) PRIMARY KEY,
    project_id VARCHAR(50) NOT NULL,
    file_name VARCHAR(200) NOT NULL,
    file_url VARCHAR(500) NOT NULL,
    file_type VARCHAR(20) NOT NULL,
    file_size BIGINT,
    upload_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (project_id) REFERENCES fifteen_projects(id)
);
```

### 十五项项目新闻链接表 (fifteen_project_news_links)
```sql
CREATE TABLE fifteen_project_news_links (
    id VARCHAR(50) PRIMARY KEY,
    project_id VARCHAR(50) NOT NULL,
    title VARCHAR(200) NOT NULL,
    url VARCHAR(500) NOT NULL,
    add_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (project_id) REFERENCES fifteen_projects(id)
);
```

### 十五项项目视频表 (fifteen_project_videos)
```sql
CREATE TABLE fifteen_project_videos (
    id VARCHAR(50) PRIMARY KEY,
    project_id VARCHAR(50) NOT NULL,
    video_name VARCHAR(200) NOT NULL,
    video_url VARCHAR(500) NOT NULL,
    video_size BIGINT,
    duration INT,
    upload_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (project_id) REFERENCES fifteen_projects(id)
);
```

## 注意事项

1. 所有文件上传接口需要支持文件大小限制和类型验证
2. 视频上传需要支持格式验证和时长限制
3. 所有接口都需要进行用户权限验证
4. 文件存储建议使用云存储服务（如阿里云OSS、腾讯云COS等）
5. 数据库连接需要配置连接池以提高性能
6. 建议实现接口限流和防刷机制
7. 所有敏感操作需要记录日志
8. 建议实现数据备份和恢复机制 