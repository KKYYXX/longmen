# 负责人转让功能测试指南

## 测试环境准备

1. **确保后端服务运行**
   - 后端服务地址：`http://127.0.0.1:5000`
   - 转让接口：`POST /user/transfer_principal`

2. **准备测试数据**
   - 当前负责人信息（姓名、手机号）
   - 被转让人信息（姓名、手机号、微信号）

## 测试步骤

### 第一步：进入当前负责人页面

1. 打开微信小程序
2. 进入"个人"页面
3. 点击"当前负责人"选项
4. 确认页面显示当前负责人信息

**预期结果**：
- 页面显示当前负责人姓名和手机号
- "转让"按钮可点击

### 第二步：点击转让按钮

1. 在当前负责人页面点击"转让"按钮

**预期结果**：
- 成功跳转到"被转让人信息"页面
- 页面显示输入表单（姓名、电话、微信号）

### 第三步：填写被转让人信息

1. **填写姓名**：输入被转让人的真实姓名
2. **填写电话**：输入被转让人的手机号
3. **填写微信号**：输入被转让人的微信号

**验证规则**：
- 姓名：不能为空
- 电话：长度至少10位
- 微信号：不能为空

**预期结果**：
- 所有字段填写完整后，"确认转让"按钮变为可点击状态
- 表单验证正常工作

### 第四步：确认转让

1. 点击"确认转让"按钮
2. 在弹出的确认对话框中点击"确认转让"

**预期结果**：
- 显示"转让中..."加载提示
- 调用后端接口进行转让验证

## 测试场景

### 场景1：转让成功

**测试数据**：
- 被转让人：真实存在的用户
- 信息：与数据库记录完全匹配
- 权限：被转让人不是当前负责人

**预期结果**：
- 接口返回200状态码
- 显示"转让成功！"提示
- 自动返回上一页

### 场景2：被转让人不存在

**测试数据**：
- 被转让人：数据库中不存在的用户

**预期结果**：
- 接口返回404状态码
- 显示"被转让用户不存在"错误提示

### 场景3：信息不匹配

**测试数据**：
- 姓名：与数据库记录不匹配
- 或微信号：与数据库记录不匹配

**预期结果**：
- 接口返回400状态码
- 显示"被转让用户信息有误，请确认"错误提示

### 场景4：被转让人已是负责人

**测试数据**：
- 被转让人：当前已经是负责人的用户

**预期结果**：
- 接口返回403状态码
- 显示"该用户已是负责人，不能转让"错误提示

### 场景5：当前用户无权限

**测试数据**：
- 当前用户：不是负责人

**预期结果**：
- 接口返回403状态码
- 显示"当前用户无权进行转让"错误提示

### 场景6：网络错误

**测试条件**：
- 后端服务未启动
- 网络连接失败

**预期结果**：
- 接口请求失败
- 显示"网络连接失败"错误提示

## 表单验证测试

### 测试1：空字段验证

1. 不填写任何信息
2. 点击"确认转让"按钮

**预期结果**：
- 显示"请完善信息"提示
- 按钮保持禁用状态

### 测试2：部分填写验证

1. 只填写姓名，不填写电话和微信号
2. 点击"确认转让"按钮

**预期结果**：
- 显示"请完善信息"提示
- 按钮保持禁用状态

### 测试3：格式验证

1. 填写姓名和微信号，电话少于10位
2. 点击"确认转让"按钮

**预期结果**：
- 显示"请完善信息"提示
- 按钮保持禁用状态

## 界面测试

### 测试1：页面布局

1. 检查页面标题是否正确
2. 检查输入框标签是否正确
3. 检查按钮文字是否正确

**预期结果**：
- 页面标题：被转让人信息
- 输入框标签：姓名、电话、微信号
- 按钮文字：确认转让

### 测试2：响应式设计

1. 在不同屏幕尺寸下测试页面显示
2. 测试输入框的焦点状态
3. 测试按钮的点击效果

**预期结果**：
- 页面在不同设备上正常显示
- 输入框获得焦点时有视觉反馈
- 按钮点击时有动画效果

## 错误处理测试

### 测试1：接口超时

1. 模拟网络延迟
2. 点击"确认转让"按钮

**预期结果**：
- 显示加载提示
- 超时后显示网络错误提示

### 测试2：服务器错误

1. 模拟服务器500错误
2. 点击"确认转让"按钮

**预期结果**：
- 显示具体的错误信息
- 用户可以重新尝试

## 测试完成标准

✅ **功能测试**：所有转让场景都能正确处理
✅ **界面测试**：页面布局和交互正常
✅ **验证测试**：表单验证规则正确执行
✅ **错误测试**：各种错误情况都有适当提示
✅ **用户体验**：操作流程顺畅，提示信息清晰

## 测试报告模板

```
测试日期：____年____月____日
测试人员：________
测试环境：微信开发者工具 / 真机

测试结果：
□ 转让成功场景：通过/失败
□ 被转让人不存在：通过/失败
□ 信息不匹配：通过/失败
□ 已是负责人：通过/失败
□ 无权限：通过/失败
□ 网络错误：通过/失败
□ 表单验证：通过/失败
□ 界面显示：通过/失败

问题记录：
1. ________________
2. ________________
3. ________________

总体评价：□ 通过 □ 需要修复
```
