<view class="document-container">
  <view class="texture-overlay"></view>
  <view class="light-spot"></view>
  
  <!-- å¤´éƒ¨å¯¼èˆª -->
  <view class="header">
    <view class="back-btn" bindtap="navigateBack">
      <text class="back-icon">â†</text>
    </view>
    <view class="title-box">
      <text class="title">{{caseData.caseName || caseData.title}}</text>
      <text class="subtitle">{{caseData.category || 'å…¸å‹æ¡ˆä¾‹'}}</text>
    </view>
    <view class="share-btn" bindtap="shareCase">
      <text class="share-icon">â‹¯</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- æ–‡æ¡£å†…å®¹ -->
  <view class="document-content" wx:if="{{!loading && caseData}}">
    <!-- æ¡ˆä¾‹åŸºæœ¬ä¿¡æ¯ -->
    <view class="case-info-card">
      <view class="case-header">
        <text class="case-title">{{caseData.caseName || caseData.title}}</text>
        <text class="case-time">{{caseData.uploadTime || caseData.createDate}}</text>
      </view>

      <!-- è‡ªåŠ¨æ“ä½œæç¤º -->
      <view class="auto-tip">
        <text class="tip-icon">ğŸ“„</text>
        <text class="tip-text">æ™ºèƒ½æ¨¡å¼ï¼šå°†è‡ªåŠ¨æ‰“å¼€å¹¶æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</text>
      </view>

      <!-- ç»Ÿè®¡ä¿¡æ¯ -->
      <view class="case-stats">
        <view class="stat-item">
          <text class="stat-icon">ğŸ“„</text>
          <text class="stat-text">{{fileCount}}ä¸ªæ–‡ä»¶</text>
        </view>
        <view class="stat-item">
          <text class="stat-icon">ğŸ¥</text>
          <text class="stat-text">{{videoCount}}ä¸ªè§†é¢‘</text>
        </view>
        <view class="stat-item">
          <text class="stat-icon">ğŸ”—</text>
          <text class="stat-text">{{linkCount}}ä¸ªé“¾æ¥</text>
        </view>
      </view>
    </view>

    <!-- æ–‡ä»¶å†…å®¹å±•ç¤ºåŒºåŸŸ -->
    <view class="file-content-container" wx:if="{{caseData.files && caseData.files.length > 0}}">
      <!-- æ–‡ä»¶å¤´éƒ¨ä¿¡æ¯ -->
      <view class="file-header-card">
        <view class="file-icon-large">
          <text class="icon">ğŸ“„</text>
        </view>
        <view class="file-info-large">
          <text class="file-name-large">{{caseData.files[0].name}}</text>
          <text class="file-size-large">{{caseData.files[0].sizeFormatted || caseData.files[0].size}}</text>
        </view>
        <view class="open-btn-large" bindtap="openMainFile">
          <text class="open-text">æ‰“å¼€æ–‡ä»¶</text>
        </view>
      </view>

      <!-- æ–‡ä»¶å†…å®¹æ˜¾ç¤ºåŒºåŸŸ -->
      <view class="file-content-display" wx:if="{{fileContent}}">
        <view class="content-header">
          <text class="content-title">ğŸ“„ æ–‡ä»¶å†…å®¹</text>
        </view>
        
        <!-- å›¾ç‰‡æ–‡ä»¶æ˜¾ç¤º -->
        <view class="image-display" wx:if="{{imageUrl}}">
          <image class="content-image" src="{{imageUrl}}" mode="widthFix" bindtap="previewImage"></image>
        </view>
        
        <!-- æ–‡æœ¬å†…å®¹æ˜¾ç¤º -->
        <view class="content-body" wx:if="{{!imageUrl}}">
          <text class="content-text">{{fileContent}}</text>
        </view>
        
        <!-- æ–‡ä»¶æ“ä½œæŒ‰é’® -->
        <view class="file-actions">
          <view class="action-btn download-action" bindtap="downloadCurrentFile">
            <text class="action-icon">â¬‡ï¸</text>
            <text class="action-text">ä¸‹è½½æ–‡ä»¶</text>
          </view>
          <view class="action-btn share-action" bindtap="shareCurrentFile">
            <text class="action-icon">ğŸ“¤</text>
            <text class="action-text">åˆ†äº«æ–‡ä»¶</text>
          </view>
        </view>
      </view>

      <!-- æ–‡ä»¶å†…å®¹æœ«å°¾çš„é™„åŠ å†…å®¹ -->
      <view class="file-appendix">
        <!-- ç›¸å…³è§†é¢‘ -->
        <view class="appendix-section" wx:if="{{caseData.videos && caseData.videos.length > 0}}">
          <view class="appendix-divider"></view>
          <text class="appendix-title">ğŸ¥ ç›¸å…³è§†é¢‘</text>
          <view class="videos-list">
            <view class="video-item-compact" wx:for="{{caseData.videos}}" wx:key="index">
              <view class="video-info-compact">
                <text class="video-icon-small">ğŸ¥</text>
                <view class="video-details-compact">
                  <text class="video-name-small">{{item.name}}</text>
                  <text class="video-duration-small" wx:if="{{item.duration}}">{{item.duration}}</text>
                </view>
              </view>
              <text class="play-btn-small" bindtap="playVideo" data-video="{{item}}">æ’­æ”¾</text>
            </view>
          </view>
        </view>

        <!-- ç›¸å…³æ–°é—» -->
        <view class="appendix-section" wx:if="{{caseData.links && caseData.links.length > 0}}">
          <view class="appendix-divider"></view>
          <text class="appendix-title">ğŸ”— ç›¸å…³æ–°é—»</text>
          <view class="links-list">
            <view class="link-item-compact" wx:for="{{caseData.links}}" wx:key="index">
              <view class="link-info-compact">
                <text class="link-icon-small">ğŸ”—</text>
                <view class="link-details-compact">
                  <text class="link-title-small">{{item.title}}</text>
                  <text class="link-url-small">{{item.url}}</text>
                </view>
              </view>
              <text class="open-btn-small" bindtap="openLink" data-link="{{item}}">æ‰“å¼€</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- é”™è¯¯çŠ¶æ€ -->
  <view class="error-container" wx:if="{{!loading && !caseData}}">
    <text class="error-icon">âŒ</text>
    <text class="error-title">åŠ è½½å¤±è´¥</text>
    <text class="error-desc">æ— æ³•è·å–æ¡ˆä¾‹è¯¦æƒ…ï¼Œè¯·é‡è¯•</text>
    <text class="retry-btn" bindtap="loadCaseDetail">é‡æ–°åŠ è½½</text>
  </view>
</view>
