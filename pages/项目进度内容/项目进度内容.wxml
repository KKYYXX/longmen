<view class="container">



    <!-- 项目信息区域 -->
    <view class="project-info-section" wx:if="{{projectInfo}}">
        <view class="section-title">项目信息</view>
        <view class="info-item">
            <text class="info-label">项目名称：</text>
            <text class="info-value">{{projectInfo.projectName}}</text>
        </view>
        <view class="info-item" wx:if="{{projectInfo.startDate && projectInfo.endDate}}">
            <text class="info-label">查询时间：</text>
            <text class="info-value">{{projectInfo.startDate}} 至 {{projectInfo.endDate}}</text>
        </view>
    </view>

    <!-- 时间查询区域 -->
    <view class="time-query-section">
        <view class="section-title">进度查询</view>
        <view class="time-buttons">
            <view
                class="time-btn {{selectedTimeRange === item.value ? 'active' : ''}}"
                wx:for="{{timeRangeOptions}}"
                wx:key="value"
                bindtap="onTimeRangeSelect"
                data-value="{{item.value}}"
            >
                {{item.label}}
            </view>
        </view>

        <!-- 自定义时间选择 -->
        <view class="custom-time-section">
            <view class="custom-time-row">
                <picker mode="date" value="{{customStartDate}}" bindchange="onCustomStartDateChange">
                    <view class="custom-date-picker">
                        <text>{{customStartDate || '开始日期'}}</text>
                    </view>
                </picker>
                <text class="date-separator">至</text>
                <picker mode="date" value="{{customEndDate}}" bindchange="onCustomEndDateChange">
                    <view class="custom-date-picker">
                        <text>{{customEndDate || '结束日期'}}</text>
                    </view>
                </picker>
                                 <view class="query-btn" bindtap="onCustomTimeQuery">查询</view>
                 <view class="reset-btn" bindtap="resetFilter">重置</view>
            </view>
        </view>
    </view>

    <!-- 进度记录加载中 -->
    <view class="progress-loading" wx:if="{{progressLoading}}">
        <text class="loading-icon">⏳</text>
        <text class="loading-text">正在查询进度记录...</text>
    </view>

    <!-- 进度记录列表 -->
    <view class="progress-records" wx:if="{{progressList.length > 0 && !progressLoading}}">
        <view class="records-title">进度记录</view>
        <view
            class="record-item"
            wx:for="{{progressList}}"
            wx:key="id"
            bindtap="selectRecord"
            data-index="{{index}}"
        >
            <!-- 记录头部：时间 -->
            <view class="record-header">
                <view class="record-time">
                    <text class="time-icon">📅</text>
                    <text class="time-text">{{item.date}}</text>
                </view>
                <!-- 添加点击提示 -->
                <view class="click-hint">
                    <text class="hint-text">点击查看详情</text>
                    <text class="hint-icon">👆</text>
                </view>
            </view>
            
            <!-- 人物信息 -->
            <view class="record-person-section">
                <text class="person-icon">👥</text>
                <text class="person-label">参与人员：</text>
                <text class="person-name">{{item.person}}</text>
            </view>
            
            <!-- 地点信息 -->
            <view class="record-location" wx:if="{{item.location && item.location !== '未知地点'}}">
                <text class="location-icon">📍</text>
                <text class="location-label">工作地点：</text>
                <text class="location-text">{{item.location}}</text>
            </view>
            
            <!-- 图片区域 -->
            <view class="media-section">
                <view class="media-header">
                    <text class="media-icon">📷</text>
                    <text class="media-label">现场图片</text>
                </view>
                <view class="media-content">
                    <view wx:if="{{item.images && item.images.length > 0}}" class="current-media">
                        <view class="media-item" wx:for="{{item.images}}" wx:key="index" wx:for-item="imageUrl">
                            <image class="media-preview" src="{{imageUrl}}" mode="aspectFill" bindtap="previewImage" data-url="{{imageUrl}}" data-urls="{{item.images}}"></image>
                        </view>
                    </view>
                    <view wx:else class="no-content">
                        <text class="no-content-text">无图片</text>
                    </view>
                </view>
            </view>
              
            <!-- 视频区域 -->
            <view class="media-section">
                <view class="media-header">
                    <text class="media-icon">🎥</text>
                    <text class="media-label">现场视频</text>
                </view>
                <view class="media-content">
                    <view wx:if="{{item.videos && item.videos.length > 0}}" class="current-media">
                        <view class="media-item" wx:for="{{item.videos}}" wx:key="index" wx:for-item="videoUrl">
                            <video class="media-preview" src="{{videoUrl}}" controls bindtap="playVideo" data-url="{{videoUrl}}"></video>
                        </view>
                    </view>
                    <view wx:else class="no-content">
                        <text class="no-content-text">无视频</text>
                    </view>
                </view>
            </view>
             
            <!-- 新闻稿区域 -->
            <view class="media-section">
                <view class="media-header">
                    <text class="media-icon">📰</text>
                    <text class="media-label">新闻稿文件</text>
                </view>
                <view class="media-content">
                    <view wx:if="{{item.newsFiles && item.newsFiles.length > 0}}" class="uploaded-files">
                        <view class="file-item" wx:for="{{item.newsFiles}}" wx:key="index">
                            <view class="file-info">
                                <view class="file-details">
                                    <text class="file-name">{{item.name}}</text>
                                    <text class="file-size">{{item.sizeText}}</text>
                                </view>
                            </view>
                            <view class="file-actions">
                                <text class="file-action preview" bindtap="previewFile" data-index="{{index}}" data-file="{{item}}">预览</text>
                            </view>
                        </view>
                    </view>
                    <view wx:else class="no-content">
                        <text class="no-content-text">无文件</text>
                    </view>
                </view>
            </view>
        </view>
    </view>

    <!-- 无进度记录提示 -->
    <view class="no-progress" wx:if="{{showNoProgress && !progressLoading}}">
        <text class="no-progress-icon">📋</text>
        <text class="no-progress-text">该时间段暂无进度记录</text>
    </view>

    <!-- 空状态 -->
    <view class="empty-state" wx:if="{{!projectInfo}}">
        <text class="empty-icon">🏗️</text>
        <text class="empty-text">请从项目查询页面进入</text>
    </view>
</view>
    