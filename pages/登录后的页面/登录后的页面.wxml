<!--pages/登录后的页面/登录后的页面.wxml-->
<view class="logged-in-container">
  <!-- 顶部装饰区域 -->
  <view class="top-decoration">
    <view class="decoration-circle circle-1"></view>
    <view class="decoration-circle circle-2"></view>
    <view class="decoration-circle circle-3"></view>
  </view>

  <!-- 右上角按钮 -->
  <view class="top-right-button">
    <view class="button-group">
      <view class="button-item">
        <text class="button-icon">⋯</text>
      </view>
      <view class="button-item">
        <text class="button-icon">🎯</text>
      </view>
    </view>
  </view>

  <!-- 主要内容区域 -->
  <view class="logged-in-content">
    <!-- 页面头部 -->
    <view class="header">
      <view class="header-icon">
        <view class="icon-container">
          <text class="icon-text">👤</text>
        </view>
      </view>
      <text class="title">用户中心</text>
      <text class="subtitle">User Center</text>
    </view>

    <!-- 未登录状态：显示登录表单 -->
    <view class="login-form-container" wx:if="{{!isLoggedIn}}">
             <!-- 切换按钮 -->
       <view class="switch-container">
         <view class="switch-btn {{currentMode === 'login' ? 'active' : ''}}" bindtap="switchToLogin">
           <text class="switch-text">登录</text>
         </view>
         <view class="switch-btn {{currentMode === 'register' ? 'active' : ''}}" bindtap="switchToRegister">
           <text class="switch-text">注册</text>
         </view>
       </view>

      <!-- 登录模式 -->
      <view class="form-container" wx:if="{{currentMode === 'login'}}">
        <view class="form-header">
          <text class="form-title">用户登录</text>
          <text class="form-subtitle">User Login</text>
        </view>

                 <!-- 登录方式切换 -->
         <view class="login-type-switch">
           <view class="type-btn {{loginType === 'phone' ? 'active' : ''}}" bindtap="switchLoginType" data-type="phone">
             <text class="type-text">手机号登录</text>
           </view>
           <view class="type-btn {{loginType === 'wechat' ? 'active' : ''}}" bindtap="switchLoginType" data-type="wechat">
             <text class="type-text">微信登录</text>
           </view>
         </view>

        <!-- 手机号登录表单 -->
        <view class="login-form" wx:if="{{loginType === 'phone'}}">
          <!-- 手机号码输入 -->
          <view class="input-group">
            <text class="input-label">手机号码</text>
            <input
              class="input-field"
              type="number"
              placeholder="请输入11位手机号码"
              value="{{loginForm.phone}}"
              bindinput="onLoginPhoneInput"
              maxlength="11"
            />
          </view>

          <!-- 密码输入 -->
          <view class="input-group">
            <text class="input-label">密码</text>
            <view class="password-container">
              <input
                class="input-field password-input"
                type="{{showLoginPassword ? 'text' : 'password'}}"
                placeholder="请输入密码"
                value="{{loginForm.password}}"
                bindinput="onLoginPasswordInput"
                maxlength="20"
                password="{{!showLoginPassword}}"
              />
              <view class="password-toggle" bindtap="toggleLoginPassword">
                <text class="toggle-icon">{{showLoginPassword ? '👁️' : '🙈'}}</text>
              </view>
            </view>
          </view>

          <!-- 登录按钮组 -->
          <view class="login-buttons">
                         <button
               class="login-btn normal-login {{isLoginFormValid ? 'active' : 'disabled'}}"
               bindtap="onNormalLogin"
               disabled="{{!isLoginFormValid}}"
             >
               <view class="btn-icon">
                 <text class="icon">👤</text>
               </view>
               <view class="btn-content">
                 <text class="btn-text">普通登录</text>
               </view>
               <view class="btn-arrow">
                 <text class="arrow">›</text>
               </view>
             </button>
            
                         <button
               class="login-btn admin-login {{isLoginFormValid ? 'active' : 'disabled'}}"
               bindtap="onAdminLogin"
               disabled="{{!isLoginFormValid}}"
             >
               <view class="btn-icon">
                 <text class="icon">⚙️</text>
               </view>
               <view class="btn-content">
                 <text class="btn-text">权限管理登录</text>
               </view>
               <view class="btn-arrow">
                 <text class="arrow">›</text>
               </view>
             </button>
          </view>
        </view>

        <!-- 微信登录表单 -->
        <view class="login-form" wx:if="{{loginType === 'wechat'}}">
          <!-- 微信号输入 -->
          <view class="input-group">
            <text class="input-label">微信号</text>
            <input
              class="input-field"
              type="text"
              placeholder="请输入微信号"
              value="{{loginForm.wechat}}"
              bindinput="onLoginWechatInput"
              maxlength="20"
            />
          </view>

          <!-- 密码输入 -->
          <view class="input-group">
            <text class="input-label">密码</text>
            <view class="password-container">
              <input
                class="input-field password-input"
                type="{{showLoginPassword ? 'text' : 'password'}}"
                placeholder="请输入密码"
                value="{{loginForm.password}}"
                bindinput="onLoginPasswordInput"
                maxlength="20"
                password="{{!showLoginPassword}}"
              />
              <view class="password-toggle" bindtap="toggleLoginPassword">
                <text class="toggle-icon">{{showLoginPassword ? '👁️' : '🙈'}}</text>
              </view>
            </view>
          </view>

          <!-- 登录按钮组 -->
          <view class="login-buttons">
            <button
              class="login-btn normal-login {{isLoginFormValid ? 'active' : 'disabled'}}"
              bindtap="onNormalLogin"
              disabled="{{!isLoginFormValid}}"
            >
              <view class="btn-icon">
                <text class="icon">👤</text>
              </view>
              <view class="btn-content">
                <text class="btn-text">普通登录</text>
              </view>
              <view class="btn-arrow">
                <text class="arrow">›</text>
              </view>
            </button>
            
            <button
              class="login-btn admin-login {{isLoginFormValid ? 'active' : 'disabled'}}"
              bindtap="onAdminLogin"
              disabled="{{!isLoginFormValid}}"
            >
              <view class="btn-icon">
                <text class="icon">⚙️</text>
              </view>
              <view class="btn-content">
                <text class="btn-text">权限管理登录</text>
              </view>
              <view class="btn-arrow">
                <text class="arrow">›</text>
              </view>
            </button>
          </view>
        </view>
      </view>

      <!-- 注册模式 -->
      <view class="form-container" wx:if="{{currentMode === 'register'}}">
        <view class="form-header">
          <text class="form-title">用户注册</text>
        </view>

        <view class="register-form">
          <!-- 姓名输入 -->
          <view class="input-group">
            <text class="input-label">姓名</text>
            <input
              class="input-field"
              type="text"
              placeholder="请输入您的姓名"
              value="{{registerForm.name}}"
              bindinput="onRegisterNameInput"
              maxlength="20"
            />
          </view>

          <!-- 手机号码输入 -->
          <view class="input-group">
            <text class="input-label">手机号码</text>
            <input
              class="input-field"
              type="number"
              placeholder="请输入11位手机号码"
              value="{{registerForm.phone}}"
              bindinput="onRegisterPhoneInput"
              maxlength="11"
            />
          </view>

          <!-- 微信号输入 -->
          <view class="input-group">
            <text class="input-label">微信号</text>
            <input
              class="input-field"
              type="text"
              placeholder="请输入微信号"
              value="{{registerForm.wechat}}"
              bindinput="onRegisterWechatInput"
              maxlength="20"
            />
          </view>

          <!-- 密码输入 -->
          <view class="input-group">
            <text class="input-label">密码</text>
            <view class="password-container">
              <input
                class="input-field password-input"
                type="{{showRegisterPassword ? 'text' : 'password'}}"
                placeholder="请输入不少于8位密码"
                value="{{registerForm.password}}"
                bindinput="onRegisterPasswordInput"
                maxlength="20"
                password="{{!showRegisterPassword}}"
              />
              <view class="password-toggle" bindtap="toggleRegisterPassword">
                <text class="toggle-icon">{{showRegisterPassword ? '👁️' : '🙈'}}</text>
              </view>
            </view>
          </view>

          <!-- 确认密码输入 -->
          <view class="input-group">
            <text class="input-label">确认密码</text>
            <view class="password-container">
              <input
                class="input-field password-input"
                type="{{showConfirmPassword ? 'text' : 'password'}}"
                placeholder="请再次输入密码"
                value="{{registerForm.confirmPassword}}"
                bindinput="onConfirmPasswordInput"
                maxlength="20"
                password="{{!showConfirmPassword}}"
              />
              <view class="password-toggle" bindtap="toggleConfirmPassword">
                <text class="toggle-icon">{{showConfirmPassword ? '👁️' : '🙈'}}</text>
              </view>
            </view>
          </view>

          <!-- 密码要求提示 -->
          <view class="password-hint">
            <text class="hint-text">密码要求：不少于8位，包含大小写字母和数字</text>
          </view>

          <!-- 注册按钮 -->
          <button
            class="submit-btn {{isRegisterFormValid ? 'active' : 'disabled'}}"
            bindtap="onRegister"
            disabled="{{!isRegisterFormValid}}"
          >
            <view class="btn-icon">
              <text class="icon">✅</text>
            </view>
            <view class="btn-content">
              <text class="btn-text">注册</text>
            </view>
            <view class="btn-arrow">
              <text class="arrow">›</text>
            </view>
          </button>
        </view>
      </view>

      <!-- 错误提示 -->
      <view class="error-message" wx:if="{{errorMessage}}">
        <view class="error-card">
          <view class="error-icon">
            <text class="icon">⚠️</text>
          </view>
          <text class="error-text">{{errorMessage}}</text>
        </view>
      </view>
    </view>

    <!-- 已登录状态：显示用户信息 -->
    <view class="user-info-container" wx:if="{{isLoggedIn}}">
      <!-- 欢迎信息 -->
      <view class="welcome-section">
        <view class="welcome-card">
          <view class="welcome-icon">
            <text class="icon">👋</text>
          </view>
          <text class="welcome-text">欢迎回来，{{userInfo.name}}</text>
        </view>
      </view>

      <!-- 用户信息卡片 -->
      <view class="user-info-section">
        <view class="section-header">
          <text class="section-title">个人信息</text>
        </view>
        
        <view class="user-info-card">
          <view class="user-avatar">
          </view>
          <view class="user-details">
            <view class="detail-item">
              <view class="detail-content">
                <text class="detail-label">姓名</text>
                <text class="detail-value">{{userInfo.name}}</text>
              </view>
            </view>
            <view class="detail-item">
              <view class="detail-content">
                <text class="detail-label">手机号</text>
                <text class="detail-value">{{userInfo.phone}}</text>
              </view>
            </view>
            <view class="detail-item">
              <view class="detail-content">
                <text class="detail-label">用户类型</text>
                <text class="detail-value">{{loginType === 'admin' ? '权限管理员' : '普通用户'}}</text>
              </view>
            </view>
          </view>
        </view>
      </view>

      <!-- 功能按钮区域 -->
      <view class="function-section">
        <view class="function-buttons">
          <!-- 权限管理中心按钮（仅权限管理员显示） -->
          <button wx:if="{{loginType === 'admin'}}" class="function-btn admin-btn" bindtap="onBackToAdmin">
            <view class="btn-icon">
              <text class="icon">⚙️</text>
            </view>
            <view class="btn-content">
              <text class="btn-text">权限管理中心</text>
            </view>
            <view class="btn-arrow">
              <text class="arrow">›</text>
            </view>
          </button>
        </view>
      </view>

      <!-- 退出登录按钮 -->
      <view class="logout-section">
        <view class="logout-btn-container">
          <button class="logout-btn" bindtap="onLogout">
            <view class="btn-icon">
              <text class="icon">🚪</text>
            </view>
            <view class="btn-content">
              <text class="btn-text">退出登录</text>
            </view>
            <view class="btn-arrow">
              <text class="arrow">›</text>
            </view>
          </button>
        </view>
      </view>
    </view>
  </view>

  <!-- 底部装饰 -->
  <view class="bottom-decoration">
    <view class="decoration-line"></view>
    <view class="decoration-dots">
      <view class="dot"></view>
      <view class="dot"></view>
      <view class="dot"></view>
    </view>
  </view>
</view>

