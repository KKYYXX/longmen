<view class="delete-manager-container">
  <view class="texture-overlay"></view>
  <view class="light-spot"></view>
  
  <!-- å¤´éƒ¨å¯¼èˆª -->
  <view class="header">
    <view class="back-btn" bindtap="navigateBack">
      <text class="back-icon">â†</text>
    </view>
    <view class="title-box">
      <text class="title">åˆ é™¤å†…å®¹</text>
      <text class="subtitle">ç®¡ç†é¡¹ç›®è¿›åº¦è®°å½•</text>
    </view>
    <view class="placeholder"></view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ä¸»è¦å†…å®¹ -->
  <view class="main-content" wx:if="{{!loading}}">
    
    <!-- æ—¶é—´ç­›é€‰å™¨ -->
    <view class="time-filter-section">
      <view class="section-header">
        <text class="section-title">ğŸ•’ æ—¶é—´ç­›é€‰</text>
        <text class="section-subtitle">é€‰æ‹©æ—¶é—´æ®µæŸ¥çœ‹è¿›åº¦è®°å½•</text>
      </view>
      
      <view class="filter-buttons">
        <view class="filter-btn {{timeFilter === 'week' ? 'active' : ''}}" bindtap="filterByTime" data-filter="week">
          <text>æœ€è¿‘ä¸€å‘¨</text>
        </view>
        <view class="filter-btn {{timeFilter === 'month' ? 'active' : ''}}" bindtap="filterByTime" data-filter="month">
          <text>æœ€è¿‘ä¸€æœˆ</text>
        </view>
        <view class="filter-btn {{timeFilter === 'year' ? 'active' : ''}}" bindtap="filterByTime" data-filter="year">
          <text>æœ€è¿‘ä¸€å¹´</text>
        </view>
        <view class="filter-btn {{timeFilter === 'all' ? 'active' : ''}}" bindtap="filterByTime" data-filter="all">
          <text>æŸ¥çœ‹å…¨éƒ¨</text>
        </view>
      </view>
      
      <!-- è‡ªå®šä¹‰æ—¥æœŸé€‰æ‹© -->
      <view class="custom-date-section">
        <picker mode="date" value="{{selectedDate}}" bindchange="onDateChange">
          <view class="date-picker-btn">
            <text class="picker-icon">ğŸ“…</text>
            <text class="picker-text">{{selectedDate || 'é€‰æ‹©å…·ä½“æ—¥æœŸ'}}</text>
            <text class="picker-arrow">â–¼</text>
          </view>
        </picker>
      </view>
    </view>

    <!-- ç»Ÿè®¡ä¿¡æ¯ -->
    <view class="stats-section">
      <view class="stats-card">
        <text class="stats-number">{{filteredProgressList.length}}</text>
        <text class="stats-label">å½“å‰è®°å½•æ•°</text>
      </view>
      <view class="stats-card">
        <text class="stats-number">{{selectedCount}}</text>
        <text class="stats-label">å·²é€‰æ‹©</text>
      </view>
    </view>

    <!-- æ‰¹é‡æ“ä½œ -->
    <view class="batch-actions" wx:if="{{selectedCount > 0}}">
      <view class="batch-btn" bindtap="selectAll">
        <text>{{isAllSelected ? 'å–æ¶ˆå…¨é€‰' : 'å…¨é€‰'}}</text>
      </view>
      <view class="batch-btn delete" bindtap="batchDelete">
        <text>æ‰¹é‡åˆ é™¤ ({{selectedCount}})</text>
      </view>
    </view>

    <!-- è¿›åº¦è®°å½•åˆ—è¡¨ -->
    <view class="progress-list-section">
      <view class="section-header">
        <text class="section-title">ğŸ“‹ è¿›åº¦è®°å½•</text>
        <text class="section-subtitle">ç‚¹å‡»é€‰æ‹©è¦åˆ é™¤çš„è®°å½•</text>
      </view>

      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:if="{{filteredProgressList.length === 0}}">
        <text class="empty-icon">ğŸ“­</text>
        <text class="empty-text">æš‚æ— ç¬¦åˆæ¡ä»¶çš„è¿›åº¦è®°å½•</text>
      </view>

      <!-- è¿›åº¦åˆ—è¡¨ -->
      <view class="progress-list" wx:if="{{filteredProgressList.length > 0}}">
        <view 
          class="progress-item {{item.selected ? 'selected' : ''}}" 
          wx:for="{{filteredProgressList}}" 
          wx:key="id"
          bindtap="toggleSelect"
          data-id="{{item.id}}"
        >
          <!-- é€‰æ‹©æ¡† -->
          <view class="select-checkbox {{item.selected ? 'checked' : ''}}">
            <text class="check-icon">{{item.selected ? 'âœ“' : ''}}</text>
          </view>

          <!-- æ—¶é—´ä¿¡æ¯ -->
          <view class="progress-time">
            <view class="time-dot {{item.status}}"></view>
            <view class="time-info">
              <text class="time-date">{{item.date}}</text>
              <text class="time-period">{{item.time}}</text>
            </view>
          </view>
          
          <!-- è¿›åº¦å†…å®¹ -->
          <view class="progress-content">
            <view class="progress-header">
              <text class="progress-title">{{item.title}}</text>
              <text class="progress-status {{item.status}}">{{item.statusText}}</text>
            </view>
            
            <view class="progress-details">
              <view class="detail-item">
                <text class="detail-icon">ğŸ“</text>
                <text class="detail-text">{{item.location}}</text>
              </view>
              <view class="detail-item">
                <text class="detail-icon">ğŸ‘¤</text>
                <text class="detail-text">{{item.person}}</text>
              </view>
            </view>
          </view>

          <!-- å•ç‹¬åˆ é™¤æŒ‰é’® -->
          <view class="single-delete-btn" bindtap="singleDelete" data-id="{{item.id}}" catchtap="singleDelete">
            <text class="delete-icon">ğŸ—‘ï¸</text>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
