<view class="app-container">
  <view class="texture-overlay"></view>
  <view class="light-spot"></view>
  
  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ä¸»è¦å†…å®¹ -->
  <view class="main-content" wx:if="{{!loading && caseData}}">
    <!-- å¤´éƒ¨ä¿¡æ¯ -->
    <view class="header">
      <view class="back-btn" bindtap="navigateBack">
        <text class="back-icon">â†</text>
      </view>
      <view class="title-box">
        <text class="title">æ¡ˆä¾‹è¯¦æƒ…</text>
        <text class="subtitle">{{caseData.caseName}}</text>
      </view>
      <view class="share-btn" bindtap="shareCase">
        <text class="share-icon">ğŸ“¤</text>
      </view>
    </view>

    <!-- æ¡ˆä¾‹åŸºæœ¬ä¿¡æ¯ -->
    <view class="case-info">
      <view class="info-card">
        <view class="info-header">
          <text class="case-title">{{caseData.caseName}}</text>
          <text class="case-time">{{caseData.uploadTime}}</text>
        </view>
        <view class="case-description">
          <text class="description-text">{{caseData.description}}</text>
        </view>
        <view class="case-stats">
          <view class="stat-item">
            <text class="stat-icon">ğŸ“„</text>
            <text class="stat-text">{{caseData.fileCount || 0}}ä¸ªæ–‡ä»¶</text>
          </view>
          <view class="stat-item">
            <text class="stat-icon">ğŸ¥</text>
            <text class="stat-text">{{caseData.videoCount || 0}}ä¸ªè§†é¢‘</text>
          </view>
          <view class="stat-item">
            <text class="stat-icon">ğŸ”—</text>
            <text class="stat-text">{{caseData.linkCount || 0}}ä¸ªé“¾æ¥</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ ‡ç­¾é¡µåˆ‡æ¢ -->
    <view class="tab-container">
      <view class="tab-header">
        <view class="tab-item {{activeTab === 'files' ? 'active' : ''}}" 
              bindtap="switchTab" data-tab="files">
          <text class="tab-icon">ğŸ“„</text>
          <text class="tab-text">æ–‡ä»¶</text>
        </view>
        <view class="tab-item {{activeTab === 'videos' ? 'active' : ''}}" 
              bindtap="switchTab" data-tab="videos">
          <text class="tab-icon">ğŸ¥</text>
          <text class="tab-text">è§†é¢‘</text>
        </view>
        <view class="tab-item {{activeTab === 'links' ? 'active' : ''}}" 
              bindtap="switchTab" data-tab="links">
          <text class="tab-icon">ğŸ”—</text>
          <text class="tab-text">æ–°é—»</text>
        </view>
      </view>
    </view>

    <!-- æ–‡ä»¶åˆ—è¡¨ -->
    <view class="content-tab" wx:if="{{activeTab === 'files'}}">
      <view class="file-list" wx:if="{{caseData.files && caseData.files.length > 0}}">
        <view class="file-item" wx:for="{{caseData.files}}" wx:key="id">
          <view class="file-info">
            <view class="file-icon">
              <text class="icon">ğŸ“„</text>
            </view>
            <view class="file-details">
              <text class="file-name">{{item.fileName}}</text>
              <text class="file-size">{{item.fileSize}}KB</text>
            </view>
          </view>
          <view class="file-actions">
            <text class="action-btn preview-btn" bindtap="previewFile" data-file="{{item}}">é¢„è§ˆ</text>
            <text class="action-btn download-btn" bindtap="downloadFile" data-file="{{item}}">ä¸‹è½½</text>
          </view>
        </view>
      </view>
      <view class="empty-state" wx:else>
        <text class="empty-icon">ğŸ“­</text>
        <text class="empty-title">æš‚æ— æ–‡ä»¶</text>
        <text class="empty-desc">è¯¥æ¡ˆä¾‹è¿˜æ²¡æœ‰ä¸Šä¼ ä»»ä½•æ–‡ä»¶</text>
      </view>
    </view>

    <!-- è§†é¢‘åˆ—è¡¨ -->
    <view class="content-tab" wx:if="{{activeTab === 'videos'}}">
      <view class="video-list" wx:if="{{caseData.videos && caseData.videos.length > 0}}">
        <view class="video-item" wx:for="{{caseData.videos}}" wx:key="id">
          <view class="video-info">
            <view class="video-icon">
              <text class="icon">ğŸ¥</text>
            </view>
            <view class="video-details">
              <text class="video-name">{{item.videoName}}</text>
              <text class="video-size">{{item.videoSize}}KB</text>
            </view>
          </view>
          <view class="video-actions">
            <text class="action-btn play-btn" bindtap="playVideo" data-video="{{item}}">æ’­æ”¾</text>
          </view>
        </view>
      </view>
      <view class="empty-state" wx:else>
        <text class="empty-icon">ğŸ“­</text>
        <text class="empty-title">æš‚æ— è§†é¢‘</text>
        <text class="empty-desc">è¯¥æ¡ˆä¾‹è¿˜æ²¡æœ‰ä¸Šä¼ ä»»ä½•è§†é¢‘</text>
      </view>
    </view>

    <!-- æ–°é—»é“¾æ¥åˆ—è¡¨ -->
    <view class="content-tab" wx:if="{{activeTab === 'links'}}">
      <view class="link-list" wx:if="{{caseData.links && caseData.links.length > 0}}">
        <view class="link-item" wx:for="{{caseData.links}}" wx:key="id">
          <view class="link-info">
            <view class="link-icon">
              <text class="icon">ğŸ”—</text>
            </view>
            <view class="link-details">
              <text class="link-title">{{item.linkTitle}}</text>
              <text class="link-url">{{item.linkUrl}}</text>
            </view>
          </view>
          <view class="link-actions">
            <text class="action-btn open-btn" bindtap="openLink" data-link="{{item}}">æ‰“å¼€</text>
          </view>
        </view>
      </view>
      <view class="empty-state" wx:else>
        <text class="empty-icon">ğŸ“­</text>
        <text class="empty-title">æš‚æ— é“¾æ¥</text>
        <text class="empty-desc">è¯¥æ¡ˆä¾‹è¿˜æ²¡æœ‰æ·»åŠ ä»»ä½•æ–°é—»é“¾æ¥</text>
      </view>
    </view>
  </view>

  <!-- é”™è¯¯çŠ¶æ€ -->
  <view class="error-container" wx:if="{{!loading && !caseData}}">
    <text class="error-icon">âŒ</text>
    <text class="error-title">åŠ è½½å¤±è´¥</text>
    <text class="error-desc">æ— æ³•è·å–æ¡ˆä¾‹è¯¦æƒ…ï¼Œè¯·é‡è¯•</text>
    <text class="retry-btn" bindtap="loadCaseDetail">é‡æ–°åŠ è½½</text>
  </view>
</view> 