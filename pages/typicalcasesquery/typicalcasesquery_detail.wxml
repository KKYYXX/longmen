<view class="app-container">
  <view class="texture-overlay"></view>
  <view class="light-spot"></view>
  
  <!-- 加载状态 -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">加载中...</text>
  </view>

  <!-- 主要内容 -->
  <view class="main-content" wx:if="{{!loading && caseData}}">
    <!-- 头部信息 -->
    <view class="header">
      <view class="back-btn" bindtap="navigateBack">
        <text class="back-icon">←</text>
      </view>
      <view class="title-box">
        <text class="title">案例详情</text>
        <text class="subtitle">{{caseData.caseName}}</text>
      </view>
      <view class="share-btn" bindtap="shareCase">
        <text class="share-icon">📤</text>
      </view>
    </view>

    <!-- 自动操作提示 -->
    <view class="auto-tip">
      <text class="tip-icon">📄</text>
      <text class="tip-text">智能模式：将自动打开并显示文件内容</text>
    </view>

    <!-- 文件内容展示区域 -->
    <view class="file-content-container" wx:if="{{caseData.files && caseData.files.length > 0}}">
      <!-- 文件头部信息 -->
      <view class="file-header-card">
        <view class="file-icon-large">
          <text class="icon">📄</text>
        </view>
        <view class="file-info-large">
          <text class="file-name-large">{{caseData.files[0].fileName}}</text>
          <text class="file-size-large">{{caseData.files[0].fileSize}}</text>
        </view>
        <view class="open-btn-large" bindtap="openMainFile">
          <text class="open-text">打开文件</text>
        </view>
      </view>

      <!-- 文件内容显示区域 -->
      <view class="file-content-display" wx:if="{{fileContent}}">
        <view class="content-header">
          <text class="content-title">📄 文件内容</text>
        </view>
        <view class="content-body">
          <text class="content-text">{{fileContent}}</text>
        </view>
      </view>

      <!-- 文件内容末尾的附加内容 -->
      <view class="file-appendix">
        <!-- 相关视频 -->
        <view class="appendix-section" wx:if="{{caseData.videos && caseData.videos.length > 0}}">
          <view class="appendix-divider"></view>
          <text class="appendix-title">🎥 相关视频</text>
          <view class="videos-list">
            <view class="video-item-compact" wx:for="{{caseData.videos}}" wx:key="id">
              <view class="video-info-compact">
                <text class="video-icon-small">🎥</text>
                <view class="video-details-compact">
                  <text class="video-name-small">{{item.videoName}}</text>
                  <text class="video-duration-small" wx:if="{{item.videoDuration}}">{{item.videoDuration}}</text>
                </view>
              </view>
              <text class="play-btn-small" bindtap="playVideo" data-video="{{item}}">播放</text>
            </view>
          </view>
        </view>

        <!-- 相关新闻 -->
        <view class="appendix-section" wx:if="{{caseData.links && caseData.links.length > 0}}">
          <view class="appendix-divider"></view>
          <text class="appendix-title">🔗 相关新闻</text>
          <view class="links-list">
            <view class="link-item-compact" wx:for="{{caseData.links}}" wx:key="id">
              <view class="link-info-compact">
                <text class="link-icon-small">🔗</text>
                <view class="link-details-compact">
                  <text class="link-title-small">{{item.linkTitle}}</text>
                  <text class="link-url-small">{{item.linkUrl}}</text>
                </view>
              </view>
              <text class="open-btn-small" bindtap="openLink" data-link="{{item}}">打开</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 错误状态 -->
  <view class="error-container" wx:if="{{!loading && !caseData}}">
    <text class="error-icon">❌</text>
    <text class="error-title">加载失败</text>
    <text class="error-desc">无法获取案例详情，请重试</text>
    <text class="retry-btn" bindtap="loadCaseDetail">重新加载</text>
  </view>
</view> 