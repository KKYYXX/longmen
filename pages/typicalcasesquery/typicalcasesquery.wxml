<!-- é¡µé¢å®¹å™¨ -->
<view class="typicalcases-query-container">
  <!-- æœç´¢åŒºåŸŸ -->
  <view class="search-section">
    <!-- æ—¶é—´ç­›é€‰ -->
    <view class="filter-row">
      <text class="filter-label">æ—¶é—´ç­›é€‰ï¼š</text>
      <picker mode="date" value="{{startDate}}" bindchange="onStartDateChange">
        <view class="date-picker">
          <text>{{startDate || 'å¼€å§‹æ—¶é—´'}}</text>
        </view>
      </picker>
      <text class="date-separator">è‡³</text>
      <picker mode="date" value="{{endDate}}" bindchange="onEndDateChange">
        <view class="date-picker">
          <text>{{endDate || 'ç»“æŸæ—¶é—´'}}</text>
        </view>
      </picker>
    </view>
    
    <!-- åç§°æœç´¢ -->
    <view class="search-box">
      <input 
        class="search-input" 
        placeholder="æœç´¢æ¡ˆä¾‹åç§°..." 
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
        bindconfirm="onSearch"
      />
      <view class="search-btn" bindtap="onSearch">
        <text class="search-icon">ğŸ”</text>
      </view>
    </view>
  </view>

  <!-- æ¡ˆä¾‹åˆ—è¡¨ -->
  <view class="case-list">
    <view 
      class="case-item {{item.expanded ? 'expanded' : ''}}" 
      wx:for="{{caseList}}" 
      wx:key="id"
      bindtap="onCaseTap"
      data-index="{{index}}"
    >
      <!-- æ¡ˆä¾‹å¤´éƒ¨ -->
      <view class="case-header">
        <view class="case-info">
          <view class="case-icon">ğŸ“‹</view>
          <view class="case-details">
            <view class="case-name">{{item.title}}</view>
            <view class="case-meta">
              <text class="case-category">{{item.category}}</text>
              <text class="case-date">{{item.createDate}}</text>
            </view>
            <view class="case-summary">{{item.summary}}</view>
          </view>
        </view>
        <view class="case-actions">
          <view class="expand-icon {{item.expanded ? 'expanded' : ''}}">â–¼</view>
        </view>
      </view>

      <!-- æ¡ˆä¾‹è¯¦æƒ…ï¼ˆå±•å¼€æ—¶æ˜¾ç¤ºï¼‰ -->
      <view class="case-content" wx:if="{{item.expanded}}">
        <view class="case-description">
          <text class="content-label">è¯¦ç»†å†…å®¹ï¼š</text>
          <text class="content-text">{{item.content}}</text>
        </view>

        <view class="case-achievements">
          <text class="content-label">ä¸»è¦æˆæ•ˆï¼š</text>
          <text class="content-text">{{item.achievements}}</text>
        </view>

        <view class="case-experience">
          <text class="content-label">ç»éªŒæ€»ç»“ï¼š</text>
          <text class="content-text">{{item.experience}}</text>
        </view>

        <!-- å›¾ç‰‡å±•ç¤º -->
        <view class="media-section" wx:if="{{item.images && item.images.length > 0}}">
          <text class="content-label">ç›¸å…³å›¾ç‰‡ï¼š</text>
          <view class="image-list">
            <view
              class="image-item"
              wx:for="{{item.images}}"
              wx:key="name"
              wx:for-item="img"
            >
              <image
                class="case-image"
                src="{{img.url}}"
                mode="aspectFill"
                bindtap="previewImage"
                data-src="{{img.url}}"
                data-urls="{{item.images}}"
              />
              <text class="image-name">{{img.name}}</text>
            </view>
          </view>
        </view>

        <!-- è§†é¢‘å±•ç¤º -->
        <view class="media-section" wx:if="{{item.videos && item.videos.length > 0}}">
          <text class="content-label">ç›¸å…³è§†é¢‘ï¼š</text>
          <view class="video-list">
            <view
              class="video-item"
              wx:for="{{item.videos}}"
              wx:key="name"
              wx:for-item="video"
            >
              <video
                class="case-video"
                src="{{video.url}}"
                controls
                poster="{{video.poster || ''}}"
              />
              <text class="video-name">{{video.name}}</text>
            </view>
          </view>
        </view>

        <!-- ç›¸å…³é“¾æ¥ -->
        <view class="media-section" wx:if="{{item.links && item.links.length > 0}}">
          <text class="content-label">ç›¸å…³é“¾æ¥ï¼š</text>
          <view class="link-list">
            <view
              class="link-item"
              wx:for="{{item.links}}"
              wx:key="name"
              wx:for-item="link"
              bindtap="openLink"
              data-url="{{link.url}}"
            >
              <text class="link-icon">ğŸ”—</text>
              <text class="link-name">{{link.name}}</text>
            </view>
          </view>
        </view>

        <!-- é¡¹ç›®æŠ¥å‘Š -->
        <view class="media-section" wx:if="{{item.reports && item.reports.length > 0}}">
          <text class="content-label">é¡¹ç›®æŠ¥å‘Šï¼š</text>
          <view class="report-list">
            <view
              class="report-item"
              wx:for="{{item.reports}}"
              wx:key="name"
              wx:for-item="report"
              bindtap="downloadReport"
              data-url="{{report.url}}"
              data-name="{{report.name}}"
            >
              <text class="report-icon">ğŸ“„</text>
              <text class="report-name">{{report.name}}</text>
              <text class="download-icon">â¬‡ï¸</text>
            </view>
          </view>
        </view>

        <!-- æ ‡ç­¾å’Œè”ç³»ä¿¡æ¯ -->
        <view class="case-footer">
          <view class="tags-section" wx:if="{{item.tags && item.tags.length > 0}}">
            <text class="content-label">æ ‡ç­¾ï¼š</text>
            <view class="tag-list">
              <text
                class="tag-item"
                wx:for="{{item.tags}}"
                wx:key="*this"
              >{{item}}</text>
            </view>
          </view>

          <view class="contact-info">
            <text class="content-label">è”ç³»æ–¹å¼ï¼š</text>
            <text class="contact-text">{{item.contact}}</text>
          </view>
        </view>

        <!-- æ–‡ä»¶å±•ç¤º -->
        <view class="media-section" wx:if="{{item.files && item.files.length > 0}}">
          <text class="content-label">ç›¸å…³æ–‡ä»¶ï¼š</text>
          <view class="file-list">
            <view 
              class="file-item" 
              wx:for="{{item.files}}" 
              wx:key="fileName"
              bindtap="downloadFile"
              data-file="{{item}}"
            >
              <text class="file-icon">ğŸ“„</text>
              <text class="file-name">{{item.fileName}}</text>
              <text class="file-size">{{item.fileSize}}</text>
            </view>
          </view>
        </view>

        <!-- è¿›åº¦è¯¦æƒ… -->
        <view class="progress-section">
          <text class="content-label">é¡¹ç›®è¿›åº¦ï¼š</text>
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{item.progress}}%"></view>
          </view>
          <text class="progress-text">{{item.progress}}% å®Œæˆ</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view class="load-more" wx:if="{{hasMore && !loading}}" bindtap="loadMore">
    <text>åŠ è½½æ›´å¤š</text>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view class="loading" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- æ²¡æœ‰æ›´å¤šæ•°æ® -->
  <view class="no-more" wx:if="{{!hasMore && caseList.length > 0}}">
    <text>æ²¡æœ‰æ›´å¤šæ•°æ®äº†</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{caseList.length === 0 && !loading}}">
    <text class="empty-icon">ğŸ“‹</text>
    <text class="empty-text">æš‚æ— å…¸å‹æ¡ˆä¾‹æ•°æ®</text>
  </view>
</view>
