# 项目进度内容页面后端接口对接说明

## 概述
本文档详细说明了项目进度内容页面与后端接口的对接实现，包括接口调用流程、参数传递、数据展示和用户交互功能。

## 后端接口对接

### 1. 获取项目进度时间列表接口
- **接口地址**: `@blue.route('/api/progress/times', methods=['GET'])`
- **调用时机**: 页面加载时自动调用
- **传递参数**: 
  - `project_name`: 项目名称（从页面传递的项目信息中获取）
- **返回数据**: 项目所有进度记录的时间点列表
- **用途**: 获取该项目所有进度记录的时间点，为后续查询详细信息做准备

### 2. 获取项目进度详细信息接口
- **接口地址**: `@blue.route('/api/progress/detail', methods=['GET'])`
- **调用时机**: 获取到时间列表后，逐个调用
- **传递参数**:
  - `project_name`: 项目名称
  - `practice_time`: 具体的时间点（从第一个接口返回的时间列表中获取）
- **返回数据**: 该时间点的详细进度记录信息
- **用途**: 获取每个时间点的具体进度内容，包括参与人员、工作地点、详细描述、媒体文件等

## 数据流程

### 页面加载流程
1. 页面接收传递的项目信息（包含项目名称）
2. 调用 `/api/progress/times` 接口，传递 `project_name` 参数
3. 获取返回的时间点列表
4. 遍历时间点列表，逐个调用 `/api/progress/detail` 接口
5. 整合所有进度记录数据
6. 处理和格式化数据，在页面上展示

### 数据传递确保
- **项目名称**: 确保 `project_name` 字段正确传递到后端
- **时间参数**: 确保 `practice_time` 字段格式正确（YYYY-MM-DD）
- **参数验证**: 在发送请求前验证必要参数的存在性

## 用户交互功能

### 记录选择功能
- 每条进度记录都可以点击查看详情
- 点击后显示记录的基本信息弹窗
- 提供"查看完整信息"选项，展示记录的完整内容

### 记录详情展示
- **基本信息**: 项目名称、记录时间、参与人员、工作地点、详细内容
- **Practice Time**: 显示该记录的 `practice_time` 值，供用户确认
- **媒体信息**: 现场图片、视频、新闻稿等资源的预览

### 时间筛选功能
- 提供预设时间范围选择（一周、一月、三月、半年、一年）
- 支持自定义时间范围查询
- 根据选择的时间范围筛选显示的进度记录

## 技术实现特点

### 1. 接口调用优化
- 使用延迟调用避免同时发送过多请求
- 请求间隔设置为100ms，平衡性能和用户体验
- 完善的错误处理和用户提示

### 2. 数据缓存机制
- 保存所有进度记录到 `allProgressList`
- 支持本地筛选，减少重复接口调用
- 提供重置筛选功能，快速恢复全部数据

### 3. 用户体验优化
- 加载状态提示
- 空数据状态处理
- 点击反馈和动画效果
- 响应式设计适配不同屏幕尺寸

## 测试要点

### 接口对接测试
1. **参数传递测试**: 确认 `project_name` 和 `practice_time` 字段正确传递
2. **响应处理测试**: 验证不同状态码的响应处理逻辑
3. **错误处理测试**: 测试网络异常、参数错误等异常情况

### 功能测试
1. **记录加载测试**: 验证进度记录的完整加载和展示
2. **记录选择测试**: 测试点击记录查看详情的功能
3. **时间筛选测试**: 验证各种时间范围的筛选功能
4. **数据展示测试**: 确认所有字段的正确显示

### 性能测试
1. **大量数据测试**: 测试大量进度记录时的加载性能
2. **网络延迟测试**: 模拟网络延迟情况下的用户体验
3. **内存使用测试**: 验证大量数据时的内存占用情况

## 注意事项

### 1. 接口参数格式
- 确保 `project_name` 字段名与后端接口要求一致
- 确保 `practice_time` 时间格式为 YYYY-MM-DD
- 注意参数值的编码和转义

### 2. 错误处理
- 网络请求失败时提供友好的用户提示
- 数据解析失败时记录详细日志便于调试
- 空数据状态的处理和用户引导

### 3. 性能考虑
- 避免一次性加载过多数据
- 合理设置请求间隔，避免对后端造成压力
- 提供加载状态提示，提升用户体验

## 总结

项目进度内容页面已成功实现与后端两个接口的完整对接：
1. `/api/progress/times` - 获取项目进度时间列表
2. `/api/progress/detail` - 获取具体时间点的进度详情

页面能够正确传递项目名称作为 `project_name` 字段，获取进度记录列表，并支持用户选择特定记录查看详细信息。所有功能都经过优化，提供了良好的用户体验和错误处理机制。
